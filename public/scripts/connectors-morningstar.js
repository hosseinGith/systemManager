/**
* Highcharts Connectors for Morningstar Direct Web Services v2.0.0 (2025-07-22)
* (c) 2009-2025 Highsoft AS
* License: https://shop.highcharts.com/contact/partner-data
**/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("highcharts/connectors-morningstar",[],t):"object"==typeof exports?exports["@highcharts/connectors-morningstar"]=t():(e.HighchartsConnectors=e.HighchartsConnectors||{},e.HighchartsConnectors.Morningstar=t())}(this,(()=>(()=>{"use strict";var e={d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{AssetAllocationsConverter:()=>qe,BondStatisticsConverter:()=>st,BondStyleBoxBreakdownConverter:()=>gt,CountryExposureConverter:()=>Je,CreditQualityBreakdownConverter:()=>tt,GlobalStockSectorBreakdownConverter:()=>Xe,GoalAnalysisConnector:()=>Ue,GoalAnalysisConverter:()=>be,HistoricalPerformanceConverter:()=>rt,HistoricalPerformanceSeriesConverter:()=>wt,IndustryBreakdownConverter:()=>Ze,IndustryGroupBreakdownConverter:()=>et,InvestmentScreenerConnector:()=>Lt,InvestmentScreenerConverter:()=>_t,InvestorPreferencesConnector:()=>Yt,InvestorPreferencesConverter:()=>Gt,MarketCapConverter:()=>Ke,MetaConverter:()=>nt,PortfolioHoldingsConverter:()=>Qe,RNANewsConnector:()=>Mt,RNANewsConverter:()=>kt,RegionalExposureConverter:()=>We,RiskScoreConnector:()=>Kt,RiskScoreConverter:()=>Xt,RiskStatisticsConverter:()=>ot,SecurityCompareConnector:()=>Tt,SecurityDetailsConnector:()=>Dt,Shared:()=>s,StyleBoxBreakdownConverter:()=>yt,TimeSeriesConnector:()=>Is,TimeSeriesConverter:()=>os,TimeSeriesConverters:()=>r,TrailingPerformanceConverter:()=>ze,UnderlyHoldingsConverter:()=>it,XRayAssetAllocationsConverter:()=>lt,XRayConnector:()=>xs,XRayCreditQualityConverter:()=>Ct,XRayGlobalStockSectorConverter:()=>ut,XRayRegionalExposureConverter:()=>ct,XRayStyleBoxConverter:()=>mt,XRayTrailingPerformanceConverter:()=>at,default:()=>Ms,version:()=>Ie});var s={};e.r(s),e.d(s,{MorningstarAPI:()=>je,MorningstarAccess:()=>Te,MorningstarError:()=>Pe,MorningstarRegion:()=>Re,MorningstarSecurityType:()=>es,MorningstarURL:()=>Fe,default:()=>rs,isMorningstarHoldingAmountOptions:()=>ts,isMorningstarHoldingValueOptions:()=>ss,isMorningstarHoldingWeightOptions:()=>ns,isPostmanEnvironmentJSON:()=>Me});var n,r={};e.r(r),e.d(r,{CumulativeReturnSeriesConverter:()=>cs,DividendSeriesConverter:()=>ds,GrowthSeriesConverter:()=>hs,OHLCVSeriesConverter:()=>ms,PriceSeriesConverter:()=>gs,RatingSeriesConverter:()=>Cs,ReturnSeriesConverter:()=>bs,RollingReturnSeriesConverter:()=>Rs,default:()=>Ds}),function(e){e.SVG_NS="http://www.w3.org/2000/svg",e.product="Highcharts",e.version="3.3.0",e.win="undefined"!=typeof window?window:{},e.doc=e.win.document,e.svg=!!e.doc?.createElementNS?.(e.SVG_NS,"svg")?.createSVGRect,e.pageLang=e.doc?.documentElement?.closest("[lang]")?.lang,e.userAgent=e.win.navigator?.userAgent||"",e.isChrome=e.win.chrome,e.isFirefox=-1!==e.userAgent.indexOf("Firefox"),e.isMS=/(edge|msie|trident)/i.test(e.userAgent)&&!e.win.opera,e.isSafari=!e.isChrome&&-1!==e.userAgent.indexOf("Safari"),e.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(e.userAgent),e.isWebKit=-1!==e.userAgent.indexOf("AppleWebKit"),e.deg2rad=2*Math.PI/360,e.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],e.noop=function(){},e.supportsPassiveEvents=function(){let t=!1;if(!e.isMS){const s=Object.defineProperty({},"passive",{get:function(){t=!0}});e.win.addEventListener&&e.win.removeEventListener&&(e.win.addEventListener("testPassive",e.noop,s),e.win.removeEventListener("testPassive",e.noop,s))}return t}(),e.charts=[],e.composed=[],e.dateFormats={},e.seriesTypes={},e.symbolSizes={},e.chartCount=0}(n||(n={}));const o=n,{charts:i,doc:a,win:l}=o;function c(e,t,s,n){const r=t?"Highcharts error":"Highcharts warning";32===e&&(e=`${r}: Deprecated member`);const i=y(e);let a=i?`${r} #${e}: www.highcharts.com/errors/${e}/`:e.toString();if(void 0!==n){let e="";i&&(a+="?"),T(n,(function(t,s){e+=`\n - ${s}: ${t}`,i&&(a+=encodeURI(s)+"="+encodeURI(t))})),a+=e}P(o,"displayError",{chart:s,code:e,message:a,params:n},(function(){if(t)throw new Error(a);l.console&&-1===c.messages.indexOf(a)&&console.warn(a)})),c.messages.push(a)}function u(e,t){return parseInt(e,t||10)}function d(e){return"string"==typeof e}function p(e){const t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t}function h(e,t){return!(!e||"object"!=typeof e||t&&p(e))}function f(e){return h(e)&&"number"==typeof e.nodeType}function m(e){const t=e?.constructor;return!(!h(e,!0)||f(e)||!t?.name||"Object"===t.name)}function y(e){return"number"==typeof e&&!isNaN(e)&&e<1/0&&e>-1/0}function g(e){return null!=e}function w(e,t,s){const n=d(t)&&!g(s);let r;const o=(t,s)=>{g(t)?e.setAttribute(s,t):n?(r=e.getAttribute(s),r||"class"!==s||(r=e.getAttribute(s+"Name"))):e.removeAttribute(s)};return d(t)?o(s,t):T(t,o),r}function C(e){return p(e)?e:[e]}function v(e,t){let s;for(s in e||(e={}),t)e[s]=t[s];return e}function b(){const e=arguments,t=e.length;for(let s=0;s<t;s++){const t=e[s];if(null!=t)return t}}function S(e,t){v(e.style,t)}function R(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))}function D(e,t){return e>1e14?e:parseFloat(e.toPrecision(t||14))}!function(e){e.messages=[]}(c||(c={}));Math.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)};const I=Array.prototype.find?function(e,t){return e.find(t)}:function(e,t){let s;const n=e.length;for(s=0;s<n;s++)if(t(e[s],s))return e[s]};function T(e,t,s){for(const n in e)Object.hasOwnProperty.call(e,n)&&t.call(s||e[n],e[n],n,e)}function A(e,t,s){function n(t,s){const n=e.removeEventListener;n&&n.call(e,t,s,!1)}function r(s){let r,o;e.nodeName&&(t?(r={},r[t]=!0):r=s,T(r,(function(e,t){if(s[t])for(o=s[t].length;o--;)n(t,s[t][o].fn)})))}const o="function"==typeof e&&e.prototype||e;if(Object.hasOwnProperty.call(o,"hcEvents")){const e=o.hcEvents;if(t){const o=e[t]||[];s?(e[t]=o.filter((function(e){return s!==e.fn})),n(t,s)):(r(e),e[t]=[])}else r(e),delete o.hcEvents}}function P(e,t,s,n){if(s=s||{},a?.createEvent&&(e.dispatchEvent||e.fireEvent&&e!==o)){const n=a.createEvent("Events");n.initEvent(t,!0,!0),s=v(n,s),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(t,s)}else if(e.hcEvents){s.target||v(s,{preventDefault:function(){s.defaultPrevented=!0},target:e,type:t});const n=[];let r=e,o=!1;for(;r.hcEvents;)Object.hasOwnProperty.call(r,"hcEvents")&&r.hcEvents[t]&&(n.length&&(o=!0),n.unshift.apply(n,r.hcEvents[t])),r=Object.getPrototypeOf(r);o&&n.sort(((e,t)=>e.order-t.order)),n.forEach((t=>{!1===t.fn.call(e,s)&&s.preventDefault()}))}n&&!s.defaultPrevented&&n.call(e,s)}let E;const k=function(){const e=Math.random().toString(36).substring(2,9)+"-";let t=0;return function(){return"highcharts-"+(E?"":e)+t++}}();l.jQuery&&(l.jQuery.fn.highcharts=function(){const e=[].slice.call(arguments);if(this[0])return e[0]?(new(o[d(e[0])?e.shift():"Chart"])(this[0],e[0],e[1]),this):i[w(this[0],"data-highcharts-chart")]});const j={addEvent:function(e,t,s,n={}){const r="function"==typeof e&&e.prototype||e;Object.hasOwnProperty.call(r,"hcEvents")||(r.hcEvents={});const i=r.hcEvents;o.Point&&e instanceof o.Point&&e.series&&e.series.chart&&(e.series.chart.runTrackerClick=!0);const a=e.addEventListener;a&&a.call(e,t,s,!!o.supportsPassiveEvents&&{passive:void 0===n.passive?-1!==t.indexOf("touch"):n.passive,capture:!1}),i[t]||(i[t]=[]);const l={fn:s,order:"number"==typeof n.order?n.order:1/0};return i[t].push(l),i[t].sort(((e,t)=>e.order-t.order)),function(){A(e,t,s)}},arrayMax:function(e){let t=e.length,s=e[0];for(;t--;)e[t]>s&&(s=e[t]);return s},arrayMin:function(e){let t=e.length,s=e[0];for(;t--;)e[t]<s&&(s=e[t]);return s},attr:w,clamp:function(e,t,s){return e>t?e<s?e:s:t},clearTimeout:function(e){g(e)&&clearTimeout(e)},correctFloat:D,createElement:function(e,t,s,n,r){const o=a.createElement(e);return t&&v(o,t),r&&S(o,{padding:"0",border:"none",margin:"0"}),s&&S(o,s),n&&n.appendChild(o),o},crisp:function(e,t=0,s){const n=t%2/2,r=s?-1:1;return(Math.round(e*r-n)+n)*r},css:S,defined:g,destroyObjectProperties:function(e,t,s){T(e,(function(n,r){n!==t&&n?.destroy&&n.destroy(),!n?.destroy&&s||delete e[r]}))},diffObjects:function(e,t,s,n){const r={};return function e(t,r,o,i){const a=s?r:t;T(t,(function(s,l){if(!i&&n&&n.indexOf(l)>-1&&r[l]){s=C(s),o[l]=[];for(let t=0;t<Math.max(s.length,r[l].length);t++)r[l][t]&&(void 0===s[t]?o[l][t]=r[l][t]:(o[l][t]={},e(s[t],r[l][t],o[l][t],i+1)))}else h(s,!0)&&!s.nodeType?(o[l]=p(s)?[]:{},e(s,r[l]||{},o[l],i+1),0!==Object.keys(o[l]).length||"colorAxis"===l&&0===i||delete o[l]):(t[l]!==r[l]||l in t&&!(l in r))&&"__proto__"!==l&&"constructor"!==l&&(o[l]=a[l])}))}(e,t,r,0),r},discardElement:function(e){e?.parentElement?.removeChild(e)},erase:function(e,t){let s=e.length;for(;s--;)if(e[s]===t){e.splice(s,1);break}},error:c,extend:v,extendClass:function(e,t){const s=function(){};return v(s.prototype=new e,t),s},find:I,fireEvent:P,getAlignFactor:(e="")=>({center:.5,right:1,middle:.5,bottom:1}[e]||0),getClosestDistance:function(e,t){const s=!t;let n,r,o,i;return e.forEach((e=>{if(e.length>1)for(r=e.length-1,i=r;i>0;i--)o=e[i]-e[i-1],o<0&&!s?(t?.(),t=void 0):o&&(void 0===n||o<n)&&(n=o)})),n},getMagnitude:R,getNestedProperty:function(e,t){const s=e.split(".");for(;s.length&&g(t);){const e=s.shift();if(void 0===e||"__proto__"===e)return;if("this"===e){let e;return h(t)&&(e=t["@this"]),e??t}const n=t[e.replace(/[\\'"]/g,"")];if(!g(n)||"function"==typeof n||"number"==typeof n.nodeType||n===l)return;t=n}return t},getStyle:function e(t,s,n){let r;if("width"===s){let s=Math.min(t.offsetWidth,t.scrollWidth);const n=t.getBoundingClientRect?.().width;return n<s&&n>=s-1&&(s=Math.floor(n)),Math.max(0,s-(e(t,"padding-left",!0)||0)-(e(t,"padding-right",!0)||0))}if("height"===s)return Math.max(0,Math.min(t.offsetHeight,t.scrollHeight)-(e(t,"padding-top",!0)||0)-(e(t,"padding-bottom",!0)||0));const o=l.getComputedStyle(t,void 0);return o&&(r=o.getPropertyValue(s),b(n,"opacity"!==s)&&(r=u(r))),r},insertItem:function(e,t){const s=e.options.index,n=t.length;let r;for(r=e.options.isInternal?n:0;r<n+1;r++)if(!t[r]||y(s)&&s<b(t[r].options.index,t[r]._i)||t[r].options.isInternal){t.splice(r,0,e);break}return r},isArray:p,isClass:m,isDOMElement:f,isFunction:function(e){return"function"==typeof e},isNumber:y,isObject:h,isString:d,merge:function(e,...t){let s,n=[e,...t],r={};const o=function(e,t){return"object"!=typeof e&&(e={}),T(t,(function(s,n){"__proto__"!==n&&"constructor"!==n&&(!h(s,!0)||m(s)||f(s)?e[n]=t[n]:e[n]=o(e[n]||{},s))})),e};!0===e&&(r=n[1],n=Array.prototype.slice.call(n,2));const i=n.length;for(s=0;s<i;s++)r=o(r,n[s]);return r},normalizeTickInterval:function(e,t,s,n,r){let o,i=e;const a=e/(s=b(s,R(e)));for(t||(t=r?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===n&&(1===s?t=t.filter((function(e){return e%1==0})):s<=.1&&(t=[1/s]))),o=0;o<t.length&&(i=t[o],!(r&&i*s>=e||!r&&a<=(t[o]+(t[o+1]||t[o]))/2));o++);return i=D(i*s,-Math.round(Math.log(.001)/Math.LN10)),i},objectEach:T,offset:function(e){const t=a.documentElement,s=e.parentElement||e.parentNode?e.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:s.top+(l.pageYOffset||t.scrollTop)-(t.clientTop||0),left:s.left+(l.pageXOffset||t.scrollLeft)-(t.clientLeft||0),width:s.width,height:s.height}},pad:function(e,t,s){return new Array((t||2)+1-String(e).replace("-","").length).join(s||"0")+e},pick:b,pInt:u,pushUnique:function(e,t){return e.indexOf(t)<0&&!!e.push(t)},relativeLength:function(e,t,s){return/%$/.test(e)?t*parseFloat(e)/100+(s||0):parseFloat(e)},removeEvent:A,replaceNested:function(e,...t){let s,n;do{for(n of(s=e,t))e=e.replace(n[0],n[1])}while(e!==s);return e},splat:C,stableSort:function(e,t){const s=e.length;let n,r;for(r=0;r<s;r++)e[r].safeI=r;for(e.sort((function(e,s){return n=t(e,s),0===n?e.safeI-s.safeI:n})),r=0;r<s;r++)delete e[r].safeI},syncTimeout:function(e,t,s){return t>0?setTimeout(e,t,s):(e.call(0,s),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ucfirst:function(e){return d(e)?e.substring(0,1).toUpperCase()+e.substring(1):String(e)},uniqueKey:k,useSerialIds:function(e){return E=b(e,E)},wrap:function(e,t,s){const n=e[t];e[t]=function(){const e=arguments,t=this;return s.apply(this,[function(){return n.apply(t,arguments.length?arguments:e)}].concat([].slice.call(arguments)))}}},x=j,{addEvent:M,fireEvent:O,merge:$}=x;class N{benchmark(e,t){const s=[],n=this,r=()=>{n.modifyTable(e),n.emit({type:"afterBenchmarkIteration"})},{iterations:o}=$({iterations:1},t);n.on("afterBenchmarkIteration",(()=>{s.length!==o?r():n.emit({type:"afterBenchmark",results:s})}));const i={startTime:0,endTime:0};return n.on("modify",(()=>{i.startTime=window.performance.now()})),n.on("afterModify",(()=>{i.endTime=window.performance.now(),s.push(i.endTime-i.startTime)})),r(),s}emit(e){O(this,e.type,e)}modify(e,t){const s=this;return new Promise(((n,r)=>{e.modified===e&&(e.modified=e.clone(!1,t));try{n(s.modifyTable(e,t))}catch(n){s.emit({type:"error",detail:t,table:e}),r(n)}}))}modifyCell(e,t,s,n,r){return this.modifyTable(e)}modifyColumns(e,t,s,n){return this.modifyTable(e)}modifyRows(e,t,s,n){return this.modifyTable(e)}on(e,t){return M(this,e,t)}}!function(e){e.types={},e.registerType=function(t,s){return!!t&&!e.types[t]&&!!(e.types[t]=s)}}(N||(N={}));const _=N;var B;!function(e){e.setLength=function(e,t,s){return Array.isArray(e)?(e.length=t,e):e[s?"subarray":"slice"](0,t)},e.splice=function(e,t,s,n,r=[]){if(Array.isArray(e))return Array.isArray(r)||(r=Array.from(r)),{removed:e.splice(t,s,...r),array:e};const o=Object.getPrototypeOf(e).constructor,i=e[n?"subarray":"slice"](t,t+s),a=new o(e.length-s+r.length);return a.set(e.subarray(0,t),0),a.set(r,t),a.set(e.subarray(t+s),t+r.length),{removed:i,array:a}}}(B||(B={}));const L=B,{setLength:F,splice:V}=L,{fireEvent:U,objectEach:G,uniqueKey:H}=x;const Y=class{constructor(e={}){this.autoId=!e.id,this.columns={},this.id=e.id||H(),this.modified=this,this.rowCount=0,this.versionTag=H(),this.columnNames=e.columnNames,this.firstRowAsNames=e.firstRowAsNames,this.orientation=e.orientation,this.dataModifier=e.dataModifier,this.beforeParse=e.beforeParse;let t=0;G(e.columns||{},((e,s)=>{this.columns[s]=e.slice(),t=Math.max(t,e.length)})),this.applyRowCount(t)}applyRowCount(e){this.rowCount=e,G(this.columns,((t,s)=>{t.length!==e&&(this.columns[s]=F(t,e))}))}deleteRows(e,t=1){if(t>0&&e<this.rowCount){let s=0;G(this.columns,((n,r)=>{this.columns[r]=V(n,e,t).array,s=n.length})),this.rowCount=s}U(this,"afterDeleteRows",{rowIndex:e,rowCount:t}),this.versionTag=H()}getColumn(e,t){return this.columns[e]}getColumns(e,t){return(e||Object.keys(this.columns)).reduce(((e,t)=>(e[t]=this.columns[t],e)),{})}getRow(e,t){return(t||Object.keys(this.columns)).map((t=>this.columns[t]?.[e]))}setColumn(e,t=[],s=0,n){this.setColumns({[e]:t},s,n)}setColumns(e,t,s){let n=this.rowCount;G(e,((e,t)=>{this.columns[t]=e.slice(),n=e.length})),this.applyRowCount(n),s?.silent||(U(this,"afterSetColumns"),this.versionTag=H())}setRow(e,t=this.rowCount,s,n){const{columns:r}=this,o=s?this.rowCount+1:t+1;G(e,((e,i)=>{let a=r[i]||!1!==n?.addColumns&&new Array(o);a&&(s?a=V(a,t,0,!0,[e]).array:a[t]=e,r[i]=a)})),o>this.rowCount&&this.applyRowCount(o),n?.silent||(U(this,"afterSetRows"),this.versionTag=H())}},{addEvent:z,defined:q,extend:W,fireEvent:X,isNumber:J,uniqueKey:Q}=x;class K extends Y{static isNull(e){if(e===K.NULL)return!0;if(e instanceof Array){if(!e.length)return!1;for(let t=0,s=e.length;t<s;++t)if(null!==e[t])return!1}else{const t=Object.keys(e);if(!t.length)return!1;for(let s=0,n=t.length;s<n;++s)if(null!==e[t[s]])return!1}return!0}constructor(e={}){super(e),this.modified=this}clone(e,t){const s=this,n={};s.emit({type:"cloneTable",detail:t}),e||(n.columns=s.columns),s.autoId||(n.id=s.id);const r=new K(n);return e||(r.versionTag=s.versionTag,r.originalRowIndexes=s.originalRowIndexes,r.localRowIndexes=s.localRowIndexes),s.emit({type:"afterCloneTable",detail:t,tableClone:r}),r}deleteColumns(e,t){const s=this,n=s.columns,r={},o={},i=s.modifier,a=s.rowCount;if((e=e||Object.keys(n)).length){s.emit({type:"deleteColumns",columnNames:e,detail:t});for(let t,s,i=0,l=e.length;i<l;++i)s=e[i],t=n[s],t&&(r[s]=t,o[s]=new Array(a)),delete n[s];return Object.keys(n).length||(s.rowCount=0,this.deleteRowIndexReferences()),i&&i.modifyColumns(s,o,0,t),s.emit({type:"afterDeleteColumns",columns:r,columnNames:e,detail:t}),r}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(e,t=1,s){const n=this,r=[],o=[],i=n.modifier;if(n.emit({type:"deleteRows",detail:s,rowCount:t,rowIndex:e||0}),void 0===e&&(e=0,t=n.rowCount),t>0&&e<n.rowCount){const s=n.columns,i=Object.keys(s);for(let a,l,c,u=0,d=i.length;u<d;++u){c=i[u],a=s[c];const p=L.splice(a,e,t);l=p.removed,s[c]=a=p.array,u||(n.rowCount=a.length);for(let e=0,t=l.length;e<t;++e)r[e]=r[e]||[],r[e][u]=l[e];o.push(new Array(d))}}return i&&i.modifyRows(n,o,e||0,s),n.emit({type:"afterDeleteRows",detail:s,rowCount:t,rowIndex:e||0,rows:r}),r}emit(e){["afterDeleteColumns","afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].includes(e.type)&&(this.versionTag=Q()),X(this,e.type,e)}getCell(e,t){const s=this.columns[e];if(s)return s[t]}getCellAsBoolean(e,t){const s=this.columns[e];return!(!s||!s[t])}getCellAsNumber(e,t,s){const n=this.columns[e];let r=n&&n[t];switch(typeof r){case"boolean":return r?1:0;case"number":return isNaN(r)&&!s?null:r}return r=parseFloat(`${r??""}`),isNaN(r)&&!s?null:r}getCellAsString(e,t){const s=this.columns[e];return`${s&&s[t]}`}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(e,t){const s=this,n=s.columns[e],r=[];if(n){const o=n.length;if(t)for(let t=0;t<o;++t)r.push(s.getCellAsNumber(e,t,!0));else{for(let e,t=0;t<o;++t){if(e=n[t],"number"==typeof e)return n.slice();if(null!=e)break}for(let t=0;t<o;++t)r.push(s.getCellAsNumber(e,t))}}return r}getColumnNames(){return Object.keys(this.columns)}getColumns(e,t,s){const n=this.columns,r={};for(let o,i,a=0,l=(e=e||Object.keys(n)).length;a<l;++a)i=e[a],o=n[i],o&&(t?r[i]=o:s&&!Array.isArray(o)?r[i]=Array.from(o):r[i]=o.slice());return r}getLocalRowIndex(e){const{localRowIndexes:t}=this;return t?t[e]:e}getModifier(){return this.modifier}getOriginalRowIndex(e){const{originalRowIndexes:t}=this;return t?t[e]:e}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,s){const n=this.columns[e];if(n){let e=-1;if((Array.isArray(n)||J(t))&&(e=n.indexOf(t,s)),-1!==e)return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(e=0,t=this.rowCount-e,s){const n=this,r=n.columns,o=new Array(t);s=s||Object.keys(r);for(let i,a,l=e,c=0,u=Math.min(n.rowCount,e+t);l<u;++l,++c){a=o[c]={};for(const e of s)i=r[e],a[e]=i?i[l]:void 0}return o}getRows(e=0,t=this.rowCount-e,s){const n=this,r=n.columns,o=new Array(t);s=s||Object.keys(r);for(let i,a,l=e,c=0,u=Math.min(n.rowCount,e+t);l<u;++l,++c){a=o[c]=[];for(const e of s)i=r[e],a.push(i?i[l]:void 0)}return o}getVersionTag(){return this.versionTag}hasColumns(e){const t=this.columns;for(let s,n=0,r=e.length;n<r;++n)if(s=e[n],!t[s])return!1;return!0}hasRowWith(e,t){const s=this.columns[e];return Array.isArray(s)?-1!==s.indexOf(t):!(!q(t)||!Number.isFinite(t))&&-1!==s.indexOf(+t)}on(e,t){return z(this,e,t)}renameColumn(e,t){const s=this.columns;return!!s[e]&&(e!==t&&(s[t]=s[e],delete s[e]),!0)}setCell(e,t,s,n){const r=this,o=r.columns,i=r.modifier;let a=o[e];a&&a[t]===s||(r.emit({type:"setCell",cellValue:s,columnName:e,detail:n,rowIndex:t}),a||(a=o[e]=new Array(r.rowCount)),t>=r.rowCount&&(r.rowCount=t+1),a[t]=s,i&&i.modifyCell(r,e,t,s),r.emit({type:"afterSetCell",cellValue:s,columnName:e,detail:n,rowIndex:t}))}setColumns(e,t,s,n){const r=this,o=r.columns,i=r.modifier,a=Object.keys(e);let l=r.rowCount;if(r.emit({type:"setColumns",columns:e,columnNames:a,detail:s,rowIndex:t}),q(t)||n){for(let s,r,i,c,u=0,d=a.length;u<d;++u){i=a[u],s=e[i],r=o[i],c=Object.getPrototypeOf(r&&n?r:s).constructor,r?c===Array?Array.isArray(r)||(r=Array.from(r)):r.length<l&&(r=new c(l),r.set(o[i])):r=new c(l),o[i]=r;for(let e=t||0,n=s.length;e<n;++e)r[e]=s[e];l=Math.max(l,s.length)}this.applyRowCount(l)}else super.setColumns(e,t,W(s,{silent:!0}));i&&i.modifyColumns(r,e,t||0),r.emit({type:"afterSetColumns",columns:e,columnNames:a,detail:s,rowIndex:t})}setModifier(e,t){const s=this;let n;return s.emit({type:"setModifier",detail:t,modifier:e,modified:s.modified}),s.modified=s,s.modifier=e,n=e?e.modify(s):Promise.resolve(s),n.then((s=>(s.emit({type:"afterSetModifier",detail:t,modifier:e,modified:s.modified}),s))).catch((t=>{throw s.emit({type:"setModifierError",error:t,modifier:e,modified:s.modified}),t}))}setOriginalRowIndexes(e,t=!1){if(this.originalRowIndexes=e,t)return;const s=this.localRowIndexes=[];for(let t,n=0,r=e.length;n<r;++n)t=e[n],q(t)&&(s[t]=n)}setRow(e,t,s,n){this.setRows([e],t,s,n)}setRows(e,t=this.rowCount,s,n){const r=this,o=r.columns,i=Object.keys(o),a=r.modifier,l=e.length;r.emit({type:"setRows",detail:n,rowCount:l,rowIndex:t,rows:e});for(let n,r=0,a=t;r<l;++r,++a)if(n=e[r],n===K.NULL)for(let e=0,t=i.length;e<t;++e){const t=o[i[e]];s?o[i[e]]=L.splice(t,a,0,!0,[null]).array:t[a]=null}else if(n instanceof Array)for(let e=0,t=i.length;e<t;++e)o[i[e]][a]=n[e];else super.setRow(n,a,void 0,{silent:!0});const c=s?l+e.length:t+l;if(c>r.rowCount){r.rowCount=c;for(let e=0,t=i.length;e<t;++e){const t=i[e];o[t]=L.setLength(o[t],c)}}a&&a.modifyRows(r,e,t),r.emit({type:"afterSetRows",detail:n,rowCount:l,rowIndex:t,rows:e})}}K.NULL={},K.version="1.0.0";const Z=K,{addEvent:ee,fireEvent:te,merge:se,pick:ne}=x;class re{constructor(e={},t=[]){this.dataTables={},this.metadata=e.metadata||{columns:{}};let s=0;if(t?.length>0)for(let e=0,n=t.length;e<n;++e){const n=t[e],r=n?.key;this.dataTables[r??s]=new Z(n),r||s++}else this.dataTables[0]=new Z(e.dataTable)}get polling(){return!!this._polling}get table(){return this.getTable()}describeColumn(e,t){const s=this.metadata.columns;s[e]=se(s[e]||{},t)}describeColumns(e){const t=this,s=Object.keys(e);let n;for(;"string"==typeof(n=s.pop());)t.describeColumn(n,e[n])}emit(e){te(this,e.type,e)}getColumnOrder(e){const t=this.metadata.columns,s=Object.keys(t||{});if(s.length)return s.sort(((e,s)=>ne(t[e].index,0)-ne(t[s].index,0)))}getTable(e){return e?this.dataTables[e]:Object.values(this.dataTables)[0]}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return te(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return ee(this,e,t)}save(){return te(this,"saveError",{table:this.table}),Promise.reject(new Error("Not implemented"))}setColumnOrder(e){const t=this;for(let s=0,n=e.length;s<n;++s)t.describeColumn(e[s],{index:s})}async setModifierOptions(e){for(const t of Object.values(this.dataTables)){const s=se(t.dataModifier,e),n=s&&_.types[s.type];await t.setModifier(n?new n(s):void 0)}return this}startPolling(e=1e3){const t=this,s=t.dataTables;this.pollingController=new AbortController,window.clearTimeout(t._polling),t._polling=window.setTimeout((()=>t.load().catch((e=>t.emit({type:"loadError",error:e,tables:s}))).then((()=>{t._polling&&t.startPolling(e)}))),e)}stopPolling(){const e=this;e?.pollingController?.abort(),window.clearTimeout(e._polling),delete e._polling}whatIs(e){return this.metadata.columns[e]}initConverters(e,t,s){let n=0;for(const[r,o]of Object.entries(this.dataTables)){const i=t(r,o);s(i,e),o.deleteColumns(),o.setColumns(i.getTable().getColumns()),0===n&&(this.converter=i),n++}}}!function(e){e.types={},e.registerType=function(t,s){return!!t&&!e.types[t]&&!!(e.types[t]=s)}}(re||(re={}));const oe=re,{addEvent:ie,fireEvent:ae,isNumber:le,merge:ce}=x;class ue{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){const t=new Date;if(!e)return NaN;let s=+e[4];return s>t.getFullYear()-2e3?s+=1900:s+=2e3,Date.UTC(s,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};const t=ce(ue.defaultOptions,e);let s=t.decimalPoint;"."!==s&&","!==s||(s="."===s?"\\.":",",this.decimalRegExp=new RegExp("^(-?[0-9]+)"+s+"([0-9]+)$")),this.options=t}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){const t=this;return{number:t.asNumber,Date:t.asDate,string:t.asString}[t.guessType(e)].call(t,e)}asNumber(e){if("number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;if("string"==typeof e){const t=this.decimalRegExp;if(e.indexOf(" ")>-1&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}return e instanceof Date?e.getDate():e?e.getRowCount():NaN}asString(e){return""+e}deduceDateFormat(e,t,s){const n=this,r=[],o=[];let i,a,l,c="YYYY/mm/dd",u=[],d=0,p=!1;for((!t||t>e.length)&&(t=e.length);d<t;d++)if(void 0!==e[d]&&e[d]&&e[d].length)for(i=e[d].trim().replace(/[\-\.\/]/g," ").split(" "),u=["","",""],l=0;l<i.length;l++)l<u.length&&(a=parseInt(i[l],10),a&&(o[l]=!o[l]||o[l]<a?a:o[l],void 0!==r[l]?r[l]!==a&&(r[l]=!1):r[l]=a,a>31?u[l]=a<100?"YY":"YYYY":a>12&&a<=31?(u[l]="dd",p=!0):u[l].length||(u[l]="mm")));if(p){for(l=0;l<r.length;l++)!1!==r[l]?o[l]>12&&"YY"!==u[l]&&"YYYY"!==u[l]&&(u[l]="YY"):o[l]>12&&"mm"===u[l]&&(u[l]="dd");3===u.length&&"dd"===u[1]&&"dd"===u[2]&&(u[2]="YY"),c=u.join("/")}return s&&(n.options.dateFormat=c),c}emit(e){ae(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),new Error("Not implemented")}getTable(){throw new Error("Not implemented")}guessType(e){const t=this;let s="string";if("string"==typeof e){const n=t.trim(`${e}`),r=t.decimalRegExp;let o=t.trim(n,!0);r&&(o=r.test(o)?o.replace(r,"$1.$2"):"");const i=parseFloat(o);if(+o===i)e=i;else{const n=t.parseDate(e);s=le(n)?"Date":"string"}}return"number"==typeof e&&(s=e>31536e6?"Date":"number"),s}on(e,t){return ie(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),new Error("Not implemented")}parseDate(e,t){const s=this,n=s.options;let r,o,i,a=t||n.dateFormat,l=NaN;if(n.parseDate)l=n.parseDate(e);else{if(a)o=s.dateFormats[a],o||(o=s.dateFormats["YYYY/mm/dd"]),i=e.match(o.regex),i&&(l=o.parser(i));else for(r in s.dateFormats)if(o=s.dateFormats[r],i=e.match(o.regex),i){a=r,l=o.parser(i);break}i||(i=Date.parse(e),"object"==typeof i&&null!==i&&i.getTime?l=i.getTime()-6e4*i.getTimezoneOffset():le(i)&&(l=i-6e4*new Date(i).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(l).getFullYear()&&(l=NaN)))}return l}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}ue.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},function(e){e.types={},e.registerType=function(t,s){return!!t&&!e.types[t]&&!!(e.types[t]=s)},e.getTableFromColumns=function(e=[],t=[]){const s=new Z;for(let n=0,r=Math.max(t.length,e.length);n<r;++n)s.setColumn(t[n]||`${n}`,e[n]);return s}}(ue||(ue={}));const de=ue,pe=globalThis.window.Dashboards,he=globalThis.window.DataGrid,fe=pe?.DataConnector||he?.DataConnector||oe,me=pe?.DataConverter||he?.DataConverter||de,ye=pe?.DataTable||he?.DataTable||Z,ge={DataConnector:fe,DataConverter:me,DataTable:ye};var we;!function(e){e.isGoalAnalysisResponse=function(e){return!!e&&"object"==typeof e&&"number"==typeof e.annualisedRequiredReturn&&"object"==typeof e.probabilityAccumulate&&e.probabilityAccumulate instanceof Array&&(0===e.probabilityAccumulate.length||function(e){return!!e&&"object"==typeof e&&"number"==typeof e.Amount&&"number"==typeof e.probability}(e.probabilityAccumulate[0]))&&"object"==typeof e.seriesData&&e.seriesData instanceof Array&&(0===e.seriesData.length||function(e){return!!e&&"object"==typeof e&&"number"==typeof e.probability&&"object"==typeof e.data&&e.data instanceof Array&&(0===e.data.length||"number"==typeof e.data[0])}(e.seriesData[0]))}}(we||(we={}));const Ce=we;const ve=class extends me{constructor(e={}){super(e),this.options=e,this.table=new ye}getTable(){return this.table}};class be extends ve{constructor(e){super(e),this.metadata={annualisedRequiredReturn:0,columns:{},expectedReturn:0,financialGoal:0,probabilityOfReachingTarget:0,requiredReturn:0,requiredReturnValue:0,standardDeviation:0,totalGain:0,totalInvestment:0,totalReturn:0,years:0}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json;if(!Ce.isGoalAnalysisResponse(n))throw new Error("Invalid data");s.deleteColumns(),s.setColumn("Goal_Probability"),s.setColumn("Goal_Amount");let r=n.seriesData?.[0]?.data;for(let e=0,t=r.length;e<t;++e)s.setColumn(`Goal_AssetClass_${e}`);let o=0,i=0;for(const e of n.probabilityAccumulate){s.setCell("Goal_Probability",i,e.probability),s.setCell("Goal_Amount",i,e.Amount),o=0,r=n.seriesData?.[i]?.data;for(const e of r)s.setCell(`Goal_AssetClass_${o}`,i,e),++o;++i}t.annualisedRequiredReturn=n.annualisedRequiredReturn,t.expectedReturn=n.expectedReturn,t.financialGoal=n.financialGoal,t.probabilityOfReachingTarget=n.probabilityOfReachingTarget,t.requiredReturn=n.requiredReturn,t.requiredReturnValue=n.requiredReturnValue,t.standardDeviation=n.standardDeviation,t.totalGain=n.totalGain,t.totalInvestment=n.totalInvestment,t.totalReturn=n.totalReturn,t.years=n.years}}const Se=be;var Re;!function(e){const t=["AG","AI","AR","AW","BB","BL","BM","BO","BQ","BR","BS","BZ","CA","CL","CO","CR","CU","CW","DM","DO","EC","FK","GD","GF","GP","GS","GT","GY","HN","HT","JM","KN","KY","LC","MF","MQ","MS","MX","NI","PA","PE","PM","PR","PY","SR","SV","UM","US","UY","VC","VE","VG","VI"],s=["AD","AE","AL","AM","AO","AT","AX","BA","BE","BF","BG","BH","BI","BJ","BW","BY","CD","CF","CG","CH","CI","CM","CV","CY","CZ","DE","DJ","DK","DZ","EE","EG","EH","ER","ES","ET","EU","FI","FO","FR","GA","GB","GE","GG","GH","GI","GL","GM","GN","GQ","GR","GW","HR","HU","IE","IL","IM","IQ","IR","IS","IT","JE","JO","KE","KW","LB","LI","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MG","MK","ML","MR","MT","MW","MZ","NA","NE","NG","NL","NO","OM","PL","PS","PT","QA","RO","RS","RW","SA","SC","SD","SE","SI","SJ","SK","SL","SM","SN","SO","SS","ST","SX","SY","SZ","TD","TF","TG","TN","TR","TZ","UA","UG","VA","YE","ZA","ZM","ZW"];e.baseURLs={Americas:"https://www.us-api.morningstar.com/",APAC:"https://www.apac-api.morningstar.com/",EMEA:"https://www.emea-api.morningstar.com/"},e.detect=function(){const e=window.navigator.language.toUpperCase().match(/-(\w\w)/u);return e?t.includes(e[1])?"Americas":s.includes(e[1])?"EMEA":"APAC":"Americas"}}(Re||(Re={}));const De=Re,Ie="2.0.0";class Te{constructor(e={}){if(this.url=e.url?new URL(e.url,window.location.href):new URL("token/oauth",De.baseURLs[De.detect()]),"https:"!==this.url.protocol)throw new Error("Insecure API protocol");e.token&&(this.token=e.token,this.tokenType="Option"),this.setPayload(e.username,e.password),delete e.password,delete e.username}async authenticate(e,t){if(window.clearTimeout(this.timeout),delete this.authorized,delete this.errorMessage,delete this.timeout,"Bearer"===this.tokenType&&(delete this.token,delete this.tokenType),"string"==typeof t&&"string"==typeof e&&this.setPayload(e,t),!this.payload)return this.token&&(this.authorized=!0),!!this.authorized;const s=this.payload,n={cache:"no-cache",credentials:"omit",headers:new Headers({Authorization:`Basic ${s}`,"User-Agent":`HighchartsConnectorsMorningstar/${Ie}`}),method:"POST",redirect:"error"};delete this.payload;try{const e=await fetch(this.url,n),t=await e.json();200===e.status&&(null!==(r=t)&&"object"==typeof r&&"string"==typeof r.access_token&&"number"==typeof r.expires_in&&"Bearer"===r.token_type)?(this.authorized=!0,this.payload=s,this.token=t.access_token,this.tokenType=t.token_type,this.setTimeout(t.expires_in)):(this.authorized=!1,function(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message}(t)&&(this.errorMessage=t.message))}catch(e){this.authorized=!1,this.errorMessage=""+e}var r;return!!this.authorized}authorizeRequest(e){const t=this.token,s="Option"===this.tokenType?"Bearer":this.tokenType;if(void 0===t||void 0===s)return e;const n=e.headers instanceof Headers?e.headers:new Headers(e.headers);return n.set("Authorization",`${s} ${t}`),e.cache="no-cache",e.credentials="same-origin",e.headers=n,e.redirect="error",e}setPayload(e,t){delete this.payload,"string"==typeof t&&"string"==typeof e&&(e=unescape(encodeURIComponent(e)),t=unescape(encodeURIComponent(t)),this.payload=btoa(`${e}:${t}`))}setTimeout(e){window.clearTimeout(this.timeout),this.timeout=window.setTimeout((()=>{this.authenticate()}),1e3*e)}setToken(e){this.authorized=!0,this.token=e,this.tokenType="Bearer"}}const Ae=Te;class Pe extends Error{constructor(e,t,s,n){super(Pe.errorMessageMap[t.statusText]||Pe.statusMessageMap[t.status]||"Unknown Error"),this.request=e,this.response=t,this.submessage=n,this.substatus=s}}!function(e){e.errorMessageMap={},e.statusMessageMap={200:"OK",302:"Found",304:"Not Modified",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",414:"Request URI Too Long",415:"Unsupported Media Type",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"}}(Pe||(Pe={}));const Ee=Pe,ke=new RegExp(["<StatusCode>([^<>]*)</StatusCode>",".*","<StatusMessage>([^<>]*)</StatusMessage>"].join(""),"su");class je{constructor(e={}){if(this.baseURL=new URL(e.url??De.baseURLs[De.detect()],window.location.href),"https:"!==this.baseURL.protocol)throw new Error("Insecure API protocol");this.lastRequestTimestamp=0,this.options=e,this.requestDelay=0,this.version=e.version??parseInt((this.baseURL.pathname.match(/\/v(\d+)(?:\/|$)/u)||[])[1],10),this.version=this.version>0?this.version:1,this.access=new Ae(e.access)}delay(e){return new Promise((t=>window.setTimeout(t,e)))}async fetch(e,t={}){"compactjson"!==e.searchParams.get("outputType")&&e.searchParams.set("outputType","json");const s=this.requestDelay-((new Date).getTime()-this.lastRequestTimestamp);s>0&&await this.delay(s),this.lastRequestTimestamp=(new Date).getTime(),(this.access.authorized||await this.access.authenticate())&&(t=this.access.authorizeRequest(t));(t.headers instanceof Headers?t.headers:new Headers(t.headers)).set("User-Agent",`HighchartsConnectorsMorningstar/${Ie}`);const n=await window.fetch(e,t);if(!n.url.startsWith("https"))throw new Error("Unsecured connection");if(n.status>=400)throw new Ee(t,n);const r=n.headers.get("Content-Type");if(r){const e=await n.blob();n.blob=async()=>e,n.json=async()=>JSON.parse(await e.text()),n.text=()=>e.text()}if(r?.startsWith("text/xml")){const e=(await n.text()).match(ke);if(e){const s=e[2].trim(),r=parseInt(e[1]);throw new Ee(t,n,r,s)}throw new Error(`Unexpected data: ${r}`)}if(!r?.startsWith("application/json"))throw new Error(`Unexpected data: ${r}`);const o=parseInt(n.headers.get("X-RateLimit-Limit")||"0",10);return o>0&&(this.requestDelay=36e5/o),n}}const xe=je;function Me(e){return null!==e&&"object"==typeof e&&"string"==typeof e.id&&"string"==typeof e.name&&"object"==typeof e.values&&e.values instanceof Array&&(0===e.values.length||Oe(e.values[0]))}function Oe(e){return!(null===e||"object"!=typeof e||"string"!=typeof e.key||"string"!=typeof e.value||"default"!==e.type&&"secret"!==e.type||void 0!==e.enabled&&"boolean"!=typeof e.enabled)}class $e{static async fromFile(e){return $e.fromJSON(JSON.parse("string"==typeof e?e:await e.text()))}static fromJSON(e){const t=[];let s="",n="";if(Me(e)){s=e.id,n=e.name;for(const s of e.values)Oe(s)&&t.push(s)}return new $e(s,n,t)}static async fromURL(e){return await this.fromFile(await(await fetch(e)).text())}constructor(e,t,s){this.id=e,this.name=t,this.values=s}getAllValuesOf(e){const t=[];if("string"==typeof e)for(const s of this.values)s.key===e&&t.push(s);else for(const s of this.values)e.test(s.key)&&t.push(s);return t}getLastValueOf(e){let t;if("string"==typeof e)for(const s of this.values)s.enabled&&s.key===e&&(t=s);else for(const s of this.values)s.enabled&&e.test(s.key)&&(t=s);return t}getValueOf(e){if("string"==typeof e){for(const t of this.values)if(t.enabled&&t.key===e)return t}else for(const t of this.values)if(t.enabled&&e.test(t.key))return t}}const Ne=$e;var _e;!function(e){function t(e){const t={},s=e.getValueOf("Morningstar as a Service Password"),n=e.getValueOf(/^Morningstar as a Service \(/u),r=e.getValueOf("Morningstar as a Service Username");return n&&(t.url=n.value,t.url.startsWith("www.")&&(t.url=`https://${t.url}`)),s&&r&&(t.access={password:s.value,username:r.value},t.url&&n&&(t.access.url=`${t.url}/token/oauth`)),t}e.getAPIOptions=async function(e={}){return e.environmentJSON?t(Ne.fromJSON(e.environmentJSON)):e.environmentURL?t(await Ne.fromURL(e.environmentURL)):{}}}(_e||(_e={}));const Be=_e;const Le=class extends fe{constructor(e={},t=[]){super(e,t),this.options=e}async load(){const e=this.options;return this.api||(this.api=new xe(e.postman?await Be.getAPIOptions(e.postman):e.api)),this.api.access.authorized||await this.api.access.authenticate(),super.load()}};class Fe extends URL{setDate(e,t){const s="number"==typeof t?new Date(t):new Date(Date.parse(t));this.searchParams.set(e,s.toISOString().substring(0,10))}setLocalizationOptions(e){this.searchParams.set("languageId",e.language.toLowerCase()+"-"+e.country.toUpperCase())}setSecuritiesOptions(e){const t=this.searchParams;let s=t.get("id")||"",n=t.get("idType")||"";for(const t of e)s=s?`${s}|${t.id}`:t.id,n=n?`${n}|${t.idType}`:t.idType;t.set("id",s),t.set("idType",n)}}const Ve=Fe;class Ue extends Le{constructor(e={}){super(e),this.converter=new Se(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(){await super.load();const e=this.options,t=this.api=this.api||new xe(e.api),s=new Ve("ecint/v1/goal-analysis",t.baseURL);if(!e.assetClassWeights)throw new Error("Option assetClassWeights is missing.");const n=s.searchParams;n.set("AssetClassWeights",e.assetClassWeights.join("|")),e.annualInvestment&&n.set("annualInvestment",`${e.annualInvestment}`),e.currentSavings&&n.set("currentSavings",`${e.currentSavings}`),"boolean"==typeof e.includeDetailedInvestmentGrowthGraph&&n.set("IncludeDetailedInvestmentGrowthGraph",e.includeDetailedInvestmentGrowthGraph?"True":"False"),e.requestProbability&&n.set("RequestProbability",`${e.requestProbability}`),e.target&&n.set("target",`${e.target}`),e.timeHorizon&&n.set("timeHorizon",`${e.timeHorizon}`);const r=await t.fetch(s),o=await r.json();return this.converter.parse({json:o}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ge.DataConnector.registerType("MorningstarGoalAnalysis",Ue);const Ge=Ue;var He;!function(e){function t(e){return!!e&&"object"==typeof e&&"string"==typeof e.Id&&"object"==typeof e.Currency&&e.TrailingPerformance?.length&&function(e){return!!e&&"object"==typeof e&&"string"==typeof e.ReturnType&&Array.isArray(e.Return)&&function(e){return!!e&&"object"==typeof e&&"number"==typeof e.Value&&"string"==typeof e.TimePeriod&&"string"==typeof e.Date&&(void 0===e.Annualized||"boolean"==typeof e.Annualized)}(e.Return[0])}(e.TrailingPerformance[0])}e.isSecurityDetails=t,e.isSecurityDetailsResponse=function(e){return Array.isArray(e)&&e.every(t)}}(He||(He={}));const Ye=He;class ze extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i=s.TrailingPerformance||[];for(let e=0,s=i.length;e<s;e++){const{Return:s,ReturnType:n,Type:r}=i[e],a=`${n}_${r}_`,l=a+"TimePeriod"+o,c=a+"Date"+o,u=a+"Value"+o;for(let e=0,n=s.length;e<n;++e){const{TimePeriod:n,Date:r,Value:o}=s[e];t.setCell(l,e,n),t.setCell(c,e,r),t.setCell(u,e,o)}}}}class qe extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i=s.Portfolios[0].AssetAllocations||[];for(let e=0;e<i.length;e++){const{Type:s,SalePosition:n,BreakdownValues:r}=i[e],a=`${s}_${n}`+o,l=`${s}_Type`+o;for(let e=0;e<r.length;e++){const{Type:s,Value:n}=r[e];t.setCell(l,e,s),t.setCell(a,e,n)}}}}class We extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=s.Portfolios[0].RegionalExposure||[];St(r,o,t,!!n)}}class Xe extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=s.Portfolios[0].GlobalStockSectorBreakdown||[];St(r,o,t,!!n)}}class Je extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i=s.Portfolios[0].CountryExposure||[],a="NotClassified"+o,l="Type"+o;t.setColumn(l),t.setColumn(a);for(let e=0;e<i.length;e++){const{SalePosition:s,BreakdownValues:n,NotClassified:r,Type:c}=i[e],u=`${c}_${s}`+o;t.setColumn(u),t.setCell(a,e,r);for(let e=0;e<n.length;e++){const{Type:s,Value:r}=n[e];t.setCell(l,e,s),t.setCell(u,e,r)}}}}class Qe extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=s.Portfolios[0].PortfolioHoldings||[];let i=0;for(const e of o){for(const s in e){const o=`${s}`+(n?`_${r}`:"");t.setCell(o,i,e[s])}++i}}}class Ke extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=s.Portfolios[0].MarketCapitalBreakdown||[];St(r,o,t,!!n)}}class Ze extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=s.Portfolios[0].IndustryBreakdown||[];St(r,o,t,!!n)}}class et extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=s.Portfolios[0].IndustryGroupBreakdown||[];St(r,o,t,!!n)}}class tt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=s.Portfolios[0].CreditQualityBreakdown||[];St(r,o,t,!!n)}}class st extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i=s.Portfolios[0].BondStatistics||{};for(const e of Object.keys(i)){const s=e+o;t.setCell(s,0,i[e])}}}class nt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i="Meta"+o,a="Value"+o,l=[["Id",s.Id],["InceptionDate",s.InceptionDate],["PerformanceInceptionDate",s.PerformanceInceptionDate],["Isin",s.Isin],["LegalName",s.LegalName],["Domicile",s.Domicile],["OngoingCharge",s.OngoingCharge],["CollectedSRRI_Date",s.CollectedSRRI?.Date],["CollectedSRRI_Rank",s.CollectedSRRI?.Rank],["Currency_Id",s.Currency?.Id],["LastPrice_Date",s.LastPrice?.Date],["LastPrice_Value",s.LastPrice?.Value],["LastPrice_Currency_Id",s.LastPrice?.Currency?.Id],["InvestmentStrategy",s.InvestmentStrategy],["ProviderCompany_Name",s.ProviderCompany?.Name],["ProviderCompany_AddressLine1",s.ProviderCompany?.AddressLine1],["ProviderCompany_Phone",s.ProviderCompany?.Phone],["ProviderCompany_City",s.ProviderCompany?.City],["ProviderCompany_Country",s.ProviderCompany?.Country],["ProviderCompany_PostalCode",s.ProviderCompany?.PostalCode],["ProviderCompany_Homepage",s.ProviderCompany?.Homepage],["CategoryBroadAssetClass_Id",s.CategoryBroadAssetClass?.Id],["CategoryBroadAssetClass_Name",s.CategoryBroadAssetClass?.Name],["ActualManagementFee",s.ActualManagementFee],["FundAttributes_DerivativeBased",s.FundAttributes?.DerivativeBased],["FundAttributes_HedgeFund",s.FundAttributes?.HedgeFund],["FundAttributes_MasterFeeder",s.FundAttributes?.MasterFeeder],["FundAttributes_PhysicalFull",s.FundAttributes?.PhysicalFull],["FundAttributes_PhysicalSample",s.FundAttributes?.PhysicalSample],["FundAttributes_SyntheticReplication",s.FundAttributes?.SyntheticReplication],["FundAttributes_UCITS",s.FundAttributes?.UCITS]],c=[],u=[];l.forEach((e=>{c.push(String(e[0])),u.push(e[1])})),t.setColumn(i,c),t.setColumn(a,u)}}class rt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0]:e.json;for(const e of o.historicalPerformanceSeries||[]){const{returnType:s,timePeriod:n,frequency:o}=e,i=`${s}_${n}_${o}`,a=`${i}_Date`+r,l=`${i}_Value`+r;let c=0;for(const s of e.returns)t.setCell(a,c,s[0]),t.setCell(l,c,s[1]),++c}}}class ot extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0].riskStatistics:e.json.riskStatistics;if(o?.sharpeRatio){let e=0;for(const s of o.sharpeRatio)t.setCell("SharpeRatio_TimePeriod"+r,e,s.timePeriod),t.setCell("SharpeRatio"+r,e,s.value),e++}if(o?.standardDeviation){let e=0;for(const s of o.standardDeviation)t.setCell("StandardDeviation_TimePeriod"+r,e,s.timePeriod),t.setCell("StandardDeviation"+r,e,s.value),e++}}}class it extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0]:e.json;let i=0;for(const e of o.underlyHoldings||[]){for(const s in e){const n=`${s}`+r;t.setCell(n,i,e[s])}++i}}}class at extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0]:e.json;for(const e of o.trailingPerformance||[]){const{returnType:s,type:n}=e,o=`${s}_${n}`,i=`${o}_TimePeriod`+r,a=`${o}_Value`+r;let l=0;for(const s of e.returns)t.setCell(i,l,s.timePeriod),t.setCell(a,l,s.value),++l}}}class lt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0].breakdowns:e.json.breakdowns;if(o?.assetAllocation)for(const e of o.assetAllocation){const s=`${e.type}_Type`+r,n=`${e.type}_${e.salePosition}`+r,o=e.values,i=Object.keys(o);for(let e=0;e<i.length;e++)t.setCell(s,e,i[e]),t.setCell(n,e,o[parseInt(i[e])])}}}class ct extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0].breakdowns:e.json.breakdowns;if(o?.regionalExposure)for(const e of o.regionalExposure){const s="Type"+r,n=`${e.salePosition}`+r,o=e.values,i=Object.keys(o);for(let e=0;e<i.length;e++)t.setCell(s,e,i[e]),t.setCell(n,e,o[parseInt(i[e])])}}}class ut extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0].breakdowns:e.json.breakdowns;if(o?.globalStockSector)for(const e of o.globalStockSector){const s="Type"+r,n=`${e.salePosition}`+r,o=e.values,i=Object.keys(o);for(let e=0;e<i.length;e++)t.setCell(s,e,i[e]),t.setCell(n,e,o[parseInt(i[e])])}}}const dt="|",pt=":",ht=[0,1,2,0,1,2,0,1,2],ft=[2,2,2,1,1,1,0,0,0];class mt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0].breakdowns:e.json.breakdowns;if(o?.styleBox)for(const e of o.styleBox){const s="Type"+r,n=`${e.salePosition}`+r,o=e.values,i=Object.keys(o);for(let e=0;e<i.length;e++)t.setCell(s,e,i[e]),t.setCell(n,e,o[parseInt(i[e])]);t.setColumn("Style"+r,ht),t.setColumn("Size"+r,ft)}}}class yt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i=s.Portfolios[0].StyleBoxBreakdown||[];St(r,i,t,!!n),t.setColumn("Style"+o,ht),t.setColumn("Size"+o,ft)}}class gt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i=s.Portfolios[0].BondStyleBoxBreakdown||[],a="Type"+o;for(let e=0;e<i.length;e++){const{SalePosition:s,BreakdownValues:n}=i[e],r=`${s}`+o;for(let e=0;e<n.length;e++){const{Type:s,Value:o}=n[e];t.setCell(a,e,s),t.setCell(r,e,o)}}t.setColumn("Term"+(n?`_${r}`:""),ht),t.setColumn("Quality"+(n?`_${r}`:""),ft)}}class wt extends ve{constructor(e){super(e)}parse(e){const t=this.table,s={...this.options,...e}.json,n=e.hasMultiple,r=s.Id,o=n?`_${r}`:"",i=s.HistoricalPerformanceSeries||[];for(let e=0,s=i.length;e<s;e++){const{ReturnType:s,TimePeriod:n,Frequency:r,Return:a}=i[e],l=`${s}_${n}_${r}`,c=l+"_Date"+o,u=l+"_Value"+o;for(let e=a.length-1;e>=0;e--){const{Date:s,Value:n}=a[e];t.setCell(c,a.length-1-e,s),t.setCell(u,a.length-1-e,n)}}}}class Ct extends ve{constructor(e){super(e)}parse(e){const t=this.table,s=e.json.benchmark,n=Array.isArray(s),r=n?"_Benchmark":"",o=n?s[0].breakdowns:e.json.breakdowns;if(o?.creditQuality)for(const e of o.creditQuality){const s="Type"+r,n=e.salePosition+r,o=e.values,i=Object.keys(o);for(let e=0;e<i.length;e++)t.setCell(s,e,i[e]),t.setCell(n,e,o[parseInt(i[e])])}}}const vt=[{key:"AssetAllocations"},{key:"BondStatistics"},{key:"BondStyleBoxBreakdown"},{key:"CountryExposure"},{key:"CreditQualityBreakdown"},{key:"GlobalStockSectorBreakdown"},{key:"HistoricalPerformanceSeries"},{key:"IndustryBreakdown"},{key:"IndustryGroupBreakdown"},{key:"MarketCap"},{key:"Meta"},{key:"PortfolioHoldings"},{key:"RegionalExposure"},{key:"StyleBoxBreakdown"},{key:"TrailingPerformance"}];function bt(e,t){switch(e?.type){case"TrailingPerformance":default:return new ze({...e,hasMultiple:t});case"AssetAllocations":return new qe({...e,hasMultiple:t});case"RegionalExposure":return new We({...e,hasMultiple:t});case"GlobalStockSectorBreakdown":return new Xe({...e,hasMultiple:t});case"CountryExposure":return new Je({...e,hasMultiple:t});case"PortfolioHoldings":return new Qe({...e,hasMultiple:t});case"MarketCap":return new Ke({...e,hasMultiple:t});case"IndustryBreakdown":return new Ze({...e,hasMultiple:t});case"IndustryGroupBreakdown":return new et({...e,hasMultiple:t});case"CreditQualityBreakdown":return new tt({...e,hasMultiple:t});case"BondStatistics":return new st({...e,hasMultiple:t});case"Meta":return new nt({...e,hasMultiple:t});case"StyleBoxBreakdown":return new yt({...e,hasMultiple:t});case"BondStyleBoxBreakdown":return new gt({...e,hasMultiple:t});case"HistoricalPerformanceSeries":return new wt({...e,hasMultiple:t})}}const St=(e,t,s,n)=>{if(!t||0===t.length)return;const r=n?`_${e}`:"",o="Type"+r,i="NotClassified"+r;s.setColumn(o),s.setColumn(i);for(let e=0;e<t.length;e++){const{SalePosition:n,NotClassified:a,BreakdownValues:l}=t[e],c=n+r;s.setColumn(c),s.setCell(i,e,a);for(let e=0;e<l.length;e++){const{Type:t,Value:n}=l[e];s.setCell(o,e,t),s.setCell(c,e,n)}}},Rt=(e,t)=>{if(t?.length){const e=vt.filter((e=>t.includes(e.key)));return e.length?e:vt}return e?.type?[{key:e.type}]:vt};class Dt extends Le{constructor(e){const{converter:t,converters:s}=e;super(e,Rt(t,s)),this.metadata={columns:{},id:"",isin:""},this.options=e}async load(e){await super.load();const t={...this.options,...e},{security:s,viewId:n="MFsnapshot"}=t,{id:r,idType:o}=s||{},i=this.api=this.api||new xe(t.api),a=new Ve(`ecint/v1/securities/${r}`,i.baseURL),l=a.searchParams;l.set("idType",""+o),l.set("responseViewFormat","json"),l.set("viewid",n);const c=await i.fetch(a),u=await c.json();if(!Ye.isSecurityDetailsResponse(u))throw new Error("Invalid data");for(const e of Object.keys(this.dataTables)){const t=bt({type:e});t.parse({json:u[0]}),this.dataTables[e].setColumns(t.getTable().getColumns())}return this.metadata={columns:{},id:u[0].Id,isin:u[0].Isin},this.setModifierOptions(t.dataModifier)}}ge.DataConnector.registerType("MorningstarSecurityDetails",Dt);const It=Dt;class Tt extends Le{constructor(e){const{converter:t,converters:s}=e;super(e,Rt(t,s)),this.metadata={columns:{},ids:[],isins:[]},this.options=e}async load(e){await super.load();const t={...this.options,...e},{security:s,viewIds:n="MFsnapshot"}=t,{ids:r,idType:o}=s||{},i=this.api=this.api||new xe(t.api),a=new Ve("ecint/v1/multi-securities/",i.baseURL),l=a.searchParams;l.set("ids",""+r.join(dt)),l.set("idType",""+o),l.set("responseViewFormat","json"),l.set("viewIds",n);const c=await i.fetch(a),u=await c.json();if(!Ye.isSecurityDetailsResponse(u))throw new Error("Invalid data");this.table.deleteColumns();for(const e of Object.keys(this.dataTables)){const t=bt({type:e},!0);for(const e of u)t.parse({json:e,hasMultiple:!0});this.dataTables[e].setColumns(t.getTable().getColumns())}this.metadata={columns:{},ids:[],isins:[]};for(const e of u)this?.metadata?.ids?.push(e.Id),this?.metadata?.isins?.push(e.Isin);return this.setModifierOptions(t.dataModifier)}}ge.DataConnector.registerType("MorningstarSecurityCompare",Tt);const At=Tt;var Pt;!function(e){e.isResponse=function(e){return!!e&&Array.isArray(e)&&(0===e.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.day&&"object"==typeof e.items&&function(e){return!!e&&Array.isArray(e)&&4===e.length&&!e.find((e=>"string"!=typeof e))}(e.items[0])}(e[0]))}}(Pt||(Pt={}));const Et=Pt;class kt extends ve{constructor(e={}){super(e),this.columns=[],this.header=[],this.options=e}parse(e){if(this.header=["Day","Title","Source","Type"],this.columns=[],!e.json)return!1;if(!Et.isResponse(e.json))throw new Error("Invalid data");const t=[];for(const s of e.json){const e=Number(s.day),n=s.items.map((t=>{const[,s,n,r]=t;return[e,s,n,r]}));t.push(...n)}const s=[];for(let e=0;e<this.header.length;e++){const n=[];for(let s=0;s<t.length;s++)n.push(t[s][e]);s.push(n)}return this.columns=s,!0}getTable(){return ve.getTableFromColumns(this.columns,this.header)}}const jt=kt;function xt(e){let t;if("string"==typeof e)if(Number.isNaN(Number(e))){const s=Date.parse(e);if(Number.isNaN(s))throw new Error(`The date ${e} is not a valid date.`);t=s}else t=Number(e);else{if("number"!=typeof e)throw new Error("The provided date is not of type string, nor number.");t=e}return new Date(t).toISOString().substring(0,10)}class Mt extends Le{constructor(e={}){super(e),this.converter=new jt(e.converter),this.options=e,void 0===this.options.api?.url&&(this.options.api={...this.options.api??{},url:De.baseURLs.EMEA})}async load(){await super.load();const e=this.options,{security:t,startDate:s,endDate:n,maxStories:r,localization:o}=e;if(!t)return this;const i=this.api=this.api||new xe(e.api),a=new Ve("ecint/v1/timeseries/rna-news",i.baseURL);if(a.setSecuritiesOptions([t]),s){const e=xt(s);a.setDate("startDate",e)}if(n){const e=xt(n);a.setDate("endDate",e)}if(r){const e=Number(r);if(!Number.isInteger(e))throw new Error(`Expected maxStories to be integer, but is instead ${r}`);a.searchParams.set("maxStories",""+r)}o&&a.setLocalizationOptions(o);const l=await i.fetch(a),c=await l.json();return this.converter.parse({json:c}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ge.DataConnector.registerType("MorningstarRNANews",Mt);const Ot=Mt;var $t;!function(e){function t(e){return!!e&&"object"==typeof e}e.isInvestmentScreenerResponse=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.rows&&e.rows instanceof Array&&(0===e.rows.length||t(e.rows[0]))},e.isInvestmentScreenerRow=t}($t||($t={}));const Nt=$t;class _t extends ve{constructor(e){super(e),this.metadata={columns:{}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json;if(!Nt.isInvestmentScreenerResponse(n))throw new Error("Invalid data");s.deleteColumns();const r=n.rows;if(r.length>0){const e=r[0];for(const t of Object.keys(e))s.setColumn(`InvestmentScreener_${t}`);for(let e=0;e<r.length;e++)for(const[t,n]of Object.entries(r[e]))s.setCell(`InvestmentScreener_${t}`,e,n);t.page=n.page,t.total=n.total,t.pageSize=n.pageSize}}}const Bt=_t;class Lt extends Le{constructor(e={universeIds:[]}){super(e),this.converter=new Bt(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(e){await super.load();const t={...this.options,...e};this.api??(this.api=new xe(t.api));const s=this.api,n=new Ve("ecint/v1/screener",s.baseURL),r=n.searchParams;if(r.set("outputType","json"),r.set("universeIds",t.universeIds.join(dt)),t.securityDataPoints&&r.set("securityDataPoints",t.securityDataPoints.join(",")),t.filters){const e=t.filters.reduce(((e,t)=>""===e?this.getFilter(t):e+dt+this.getFilter(t)),"");r.set("filters",e)}t.ignoreRestructure&&r.set("ignoreRestructure",`${t.ignoreRestructure}`),t.term&&r.set("term",t.term),t.applyTrackRecordExtension&&r.set("applyTrackRecordExtension",`${t.applyTrackRecordExtension}`),t.page&&r.set("page",`${t.page}`),t.pageSize&&r.set("pageSize",`${t.pageSize||1}`),t.sortOrder&&r.set("sortOrder",t.sortOrder),t.countryId&&r.set("countryId",t.countryId),t.currencyId&&r.set("currencyId",t.currencyId);const o=await s.fetch(n),i=await o.json();return this.converter.parse({json:i}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(t.dataModifier)}getFilter(e){return`${e.dataPointId}${pt}${e.comparatorCode}${pt}${e.value}`}}ge.DataConnector.registerType("MorningstarInvestmentScreener",Lt);const Ft=Lt;var Vt;!function(e){function t(e){return!!e&&"object"==typeof e}e.isInvestorPreferencesResponse=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.rows&&e.rows instanceof Array&&(0===e.rows.length||t(e.rows[0]))},e.isInvestorPreferenceRow=t}(Vt||(Vt={}));const Ut=Vt;class Gt extends ve{constructor(e){super(e),this.metadata={columns:{}}}parse(e){const t=this.metadata,s=this.table,n={...this.options,...e}.json;if(!Ut.isInvestorPreferencesResponse(n))throw new Error("Invalid data");s.deleteColumns();const r=n.rows;if(r.length>0){const e=r[0];for(const t of Object.keys(e))s.setColumn(`InvestorPreferences_${t}`);for(let e=0;e<r.length;e++)for(const[t,n]of Object.entries(r[e]))s.setCell(`InvestorPreferences_${t}`,e,n);t.page=n.page,t.total=n.total,t.pageSize=n.pageSize}}}const Ht=Gt;class Yt extends Le{constructor(e={universeIds:[]}){super(e),this.converter=new Ht(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(e){await super.load();const t={...this.options,...e},s=this.api=this.api||new xe(t.api),n=new Ve("ecint/v1/screener",s.baseURL),r={universeIds:t.universeIds.join(dt),outputType:"json"};t.page&&(r.page=`${t.page}`),t.pageSize&&(r.pageSize=`${t.pageSize}`),t.sortOrder&&(r.sortOrder=`${t.sortOrder}`),t.languageId&&(r.languageId=`${t.languageId}`),t.currencyId&&(r.currencyId=`${t.currencyId}`),t.securityDataPoints&&(r.securityDataPoints=t.securityDataPoints),t.calculatedDataPoints&&(this.metadata.calculatedDataPointNames=t.calculatedDataPoints.map((e=>e.name)),r.calculatedDataPoints=t.calculatedDataPoints.map((e=>({...e,type:"bool"})))),t.filters&&(r.filters=t.filters.reduce(((e,t)=>""===e?this.getFilter(t):e+dt+this.getFilter(t)),"")),t.filterDataPoints&&(r.filterDataPoints=t.filterDataPoints.join(dt)),t.term&&(r.term=t.term),t.countryId&&(r.countryId=t.countryId),t.applyTrackRecordExtension&&(r.applyTrackRecordExtension=t.applyTrackRecordExtension),t.ignoreRestructure&&(r.ignoreRestructure=t.ignoreRestructure);const o=await s.fetch(n,{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"}),i=await o.json();return this.converter.parse({json:i}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(t.dataModifier)}getFilter(e){return`${e.dataPointId}${pt}${e.comparatorCode}${pt}${e.value}`}}ge.DataConnector.registerType("MorningstarInvestorPreferences",Yt);const zt=Yt;var qt;!function(e){e.isResponse=function(e){return!!e&&"object"==typeof e&&Array.isArray(e.riskScores)&&(0===e.riskScores.length||function(e){return!!e&&"object"==typeof e&&"object"==typeof e.portfolio&&function(e){return!!e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.riskScore&&"number"==typeof e.alignmentScore&&"number"==typeof e.rSquared&&"number"==typeof e.retainedWeightProxied&&"string"==typeof e.scoringMethodUsed&&"string"==typeof e.effectiveDate}(e.portfolio)&&(void 0===e.metadata||function(e){return!!e&&"object"==typeof e&&function(e){return!!e&&Array.isArray(e)&&(0===e.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.type&&"string"==typeof e.message&&Array.isArray(e.invalidHoldings)&&(0===e.invalidHoldings.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.identifier&&"string"==typeof e.identifierType&&"string"==typeof e.status}(e.invalidHoldings[0]))}(e[0]))}(e.messages)}(e.metadata))}(e.riskScores[0]))}}(qt||(qt={}));const Wt=qt;class Xt extends ve{constructor(e={}){super(e),this.options=e,this.metadata={columns:{},messages:[]}}parse(e){const t=this.table,s={...this.options,...e}.json;if(!Wt.isResponse(s))throw new Error("Invalid data");const n=[],r=[];for(const e of s.riskScores){const{externalId:t,name:s,effectiveDate:o,riskScore:i,alignmentScore:a,rSquared:l,retainedWeightProxied:c,scoringMethodUsed:u}=e.portfolio;n.push({externalId:t,name:s,effectiveDate:Date.parse(o),riskScore:i,alignmentScore:a,rSquared:l,retainedWeightProxied:c,scoringMethodUsed:u}),void 0!==e.metadata&&e.metadata.messages.length>0&&r.push(...e.metadata.messages)}n.sort(((e,t)=>e.effectiveDate===t.effectiveDate?0:e.effectiveDate<t.effectiveDate?-1:1));const o=n.map((e=>e.name));t.deleteColumns();const i=["EffectiveDate","RiskScore","AlignmentScore","RSquared","RetainedWeightProxied","ScoringMethodUsed"];for(const e of o)for(const s of i)t.setColumn(`${e}_${s}`);for(let e=0;e<n.length;e++){const s=n[e],r=[s.effectiveDate,s.riskScore,s.alignmentScore,s.rSquared,s.retainedWeightProxied,s.scoringMethodUsed];for(let n=0;n<r.length;n++){const o=`${s.name}_${i[n]}`,a=r[n];t.setCell(o,Number(e),a)}}return this.metadata.messages=r,!0}}const Jt=Xt;function Qt(e,t){let s;for(const n of e){let e;const r=n.name??n.id;if(void 0!==n.weight&&void 0!==n.value)throw new Error(`The holding ${r} in the portfolio ${t} cannot have both weight and value.`);if(void 0!==n.weight)e="weight";else{if(void 0===n.value)throw new Error(`The holding ${r} in the portfolio ${t} does not have a value nor a weight.`);e="value"}if(void 0===s&&(s=e),e!==s)throw new Error(`The holdings in the portfolio ${t} mix and match between using value and weight. This is not allowed.`)}}class Kt extends Le{constructor(e={}){super(e),this.converter=new Jt(e.converter),this.metadata=this.converter.metadata,this.options=e}async load(){await super.load();const e=this.options,t=e.portfolios;if(!t||0===t.length)return this;for(const e of t)Qt(e.holdings,e.name);const s={Portfolios:[...t].map((e=>(Object.assign(e,{holdings:e.holdings.map((e=>function(e){const t={identifier:e.id,identifierType:e.idType,name:e.name},s=e;return void 0!==s.weight?t.weight=s.weight:void 0!==s.value&&(t.value=s.value),t}(e)))}),void 0===e.currency&&(e.currency="BAS"),e)))},n=this.api=this.api||new xe(e.api),r=new Ve("/portfolio-analysis/v1/risk-score",n.baseURL),o=await n.fetch(r,{body:JSON.stringify(s),headers:{"Content-Type":"application/json"},method:"POST"}),i=await o.json();return this.converter.parse({json:i}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ge.DataConnector.registerType("MorningstarRiskScore",Kt);const Zt=Kt;var es;function ts(e){return!!e&&"object"==typeof e&&("number"==typeof e.amount||"string"==typeof e.amount)&&void 0===e.value&&void 0===e.weight}function ss(e){return!!e&&"object"==typeof e&&void 0===e.amount&&("number"==typeof e.value||"string"==typeof e.value)&&void 0===e.weight}function ns(e){return!!e&&"object"==typeof e&&void 0===e.amount&&void 0===e.value&&("number"==typeof e.weight||"string"==typeof e.weight)}!function(e){e.Bond="BD",e.Cash="CASH",e.CategoryAverage="CA",e.ClosedEndFund="FC",e.EconomicsSeries="EI",e.ExchangeTradedFund="FE",e.Index="XI",e.InsuranceProductFund="FV",e.MoneyMarketFund="FM",e.OpenEndFund="FO",e.Portfolio529="CT",e.SeparateAccount="SA",e.Stock="ST",e.UKLPSubAccounts="VA",e.UnitInvestmentTrust="FI",e.VariableAnnuity="V1"}(es||(es={}));const rs={isPostmanEnvironmentJSON:Me,MorningstarAccess:Ae,MorningstarAPI:xe,MorningstarError:Ee,MorningstarRegion:De,MorningstarURL:Ve};class os extends ve{decorateURL(e){}}const is=os;var as;!function(e){function t(e){return!!e&&"object"==typeof e&&"object"==typeof e.Security&&e.Security instanceof Array&&(0===e.Security.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.Id&&(void 0===e.CumulativeReturnSeries||e.CumulativeReturnSeries instanceof Array)&&(void 0===e.DividendSeries||e.DividendSeries instanceof Array)&&(void 0===e.RatingSeries||e.RatingSeries instanceof Array)&&(void 0===e.HistoryDetail||e.HistoryDetail instanceof Array)&&(void 0===e.ReturnSeries||e.ReturnSeries instanceof Array)&&(void 0===e.RollingReturn||e.RollingReturn instanceof Array)}(e.Security[0]))}e.isCompactJSONOHLCVResponse=function(e){return function(e){return!!e&&e instanceof Array}(e)&&(0===e.length||function(e){return!!e&&Array.isArray(e)&&6===e.length}(e[0]))},e.isHistory=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.HistoryDetail&&e.HistoryDetail instanceof Array&&(0===e.HistoryDetail.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.EndDate&&"string"==typeof e.Value}(e.HistoryDetail[0]))},e.isResponse=function(e){return!!e&&"object"==typeof e&&"object"==typeof e.TimeSeries&&t(e.TimeSeries)},e.isTimeSeriesResponse=t}(as||(as={}));const ls=as;class cs extends is{constructor(e={type:"CumulativeReturn"}){super(e),this.path="timeseries/cumulativereturn",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!ls.isResponse(s))throw new Error("Invalid data");const n=[],r=[];for(const e of s.TimeSeries.Security)if(e.CumulativeReturnSeries){n.push(e.Id);for(const t of e.CumulativeReturnSeries)for(const s of t.HistoryDetail)r.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}r.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let o=0,i=-1;for(const e of r)o!==e.EndDate&&(o=e.EndDate,t.setCell("Date",++i,o)),t.setCell(e.Id,i,e.Value)}}const us=cs;class ds extends is{constructor(e={type:"Dividend"}){super(e),this.path="timeseries/dividend",this.options=e}parse(e){const t=this.table,s={...this.options,...e},n=s.includeCurrency,r=s.json;if(!ls.isTimeSeriesResponse(r))throw new Error("Invalid data");const o=[],i=[];for(const e of r.Security)if(e.DividendSeries){o.push(e.Id);for(const t of e.DividendSeries)for(const s of t.HistoryDetail)i.push({CurrencyId:s.Value[0].CurrencyId,EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value[0].value)})}i.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of o)t.setColumn(e),n&&t.setColumn(`${e}_Currency`);let a=0,l=-1;for(const e of i)a!==e.EndDate&&(a=e.EndDate,t.setCell("Date",++l,a)),t.setCell(e.Id,l,e.Value),n&&t.setCell(`${e.Id}_Currency`,l,e.CurrencyId)}}const ps=ds;class hs extends is{constructor(e={type:"Growth"}){super(e),this.path="timeseries/growth",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!ls.isResponse(s))throw new Error("Invalid data");const n=[],r=[];for(const e of s.TimeSeries.Security)if(e.GrowthSeries){n.push(e.Id);for(const t of e.GrowthSeries)for(const s of t.HistoryDetail)r.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}r.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let o=0,i=-1;for(const e of r)o!==e.EndDate&&(o=e.EndDate,t.setCell("Date",++i,o)),t.setCell(e.Id,i,e.Value)}}const fs=hs;class ms extends is{constructor(e={type:"OHLCV"}){super(e),this.path="timeseries/ohlcv",this.options=e}parse(e){const t=this.table,s={...this.options,...e},n=s.json;if(!ls.isCompactJSONOHLCVResponse(n))throw new Error("Invalid data");const r=s.securities?.map((e=>e.id))??[],o=[];for(const e of n){const[t,,,,n,i]=e;let[,a,l,c]=e;0===i&&s.replaceZeroWithCloseValue&&(a=n,l=n,c=n),o.push({Id:r[0],Date:t,Value:[a,l,c,n,i]})}o.sort(((e,t)=>e.Date===t.Date?0:e.Date<t.Date?-1:1)),t.deleteColumns();const i=["Open","High","Low","Close","Volume"];t.setColumn("Date");for(const e of r)for(const s of i)t.setColumn(`${e}_${s}`);let a=0,l=-1;for(const e of o){a!==e.Date&&(a=e.Date,t.setCell("Date",++l,a));for(const s in e.Value){const n=`${e.Id}_${i[s]}`,r=e.Value[s];t.setCell(n,l,r)}}}decorateURL(e){e.searchParams.set("outputType","compactjson")}}const ys=ms;class gs extends is{constructor(e={type:"Price"}){super(e),this.path="timeseries/price",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!ls.isResponse(s))throw new Error("Invalid data");const n=[],r=[];for(const e of s.TimeSeries.Security)if(e.HistoryDetail){n.push(e.Id);for(const t of e.HistoryDetail)r.push({EndDate:Date.parse(t.EndDate),Id:e.Id,Value:parseFloat(t.Value)})}r.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let o=0,i=-1;for(const e of r)o!==e.EndDate&&(o=e.EndDate,t.setCell("Date",++i,o)),t.setCell(e.Id,i,e.Value)}decorateURL(e){void 0!==this.options.priceType&&e.searchParams.set("priceType",this.options.priceType)}}const ws=gs;class Cs extends is{constructor(e={type:"Rating"}){super(e),this.path="timeseries/rating",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!ls.isTimeSeriesResponse(s))throw new Error("Invalid data");const n=[],r=[];for(const e of s.Security)if(e.RatingSeries){n.push(e.Id);for(const t of e.RatingSeries)for(const s of t.HistoryDetail)r.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}r.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let o=0,i=-1;for(const e of r)o!==e.EndDate&&(o=e.EndDate,t.setCell("Date",++i,o)),t.setCell(e.Id,i,e.Value)}}const vs=Cs;class bs extends is{constructor(e={type:"Return"}){super(e),this.path="timeseries/return",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!ls.isResponse(s))throw new Error("Invalid data");const n=[],r=[];for(const e of s.TimeSeries.Security)if(e.ReturnSeries){n.push(e.Id);for(const t of e.ReturnSeries)for(const s of t.HistoryDetail)r.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}r.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let o=0,i=-1;for(const e of r)o!==e.EndDate&&(o=e.EndDate,t.setCell("Date",++i,o)),t.setCell(e.Id,i,e.Value)}}const Ss=bs;class Rs extends is{constructor(e={type:"RollingReturn"}){super(e),this.path="timeseries/rollingreturn",this.options=e}parse(e){const t=this.table,s={...this.options,...e}.json;if(!ls.isResponse(s))throw new Error("Invalid data");const n=[],r=[];for(const e of s.TimeSeries.Security)if(e.RollingReturn){n.push(e.Id);for(const t of e.RollingReturn)for(const s of t.HistoryDetail)r.push({EndDate:Date.parse(s.EndDate),Id:e.Id,Value:parseFloat(s.Value)})}r.sort(((e,t)=>e.EndDate===t.EndDate?0:e.EndDate<t.EndDate?-1:1)),t.deleteColumns(),t.setColumn("Date");for(const e of n)t.setColumn(e);let o=0,i=-1;for(const e of r)o!==e.EndDate&&(o=e.EndDate,t.setCell("Date",++i,o)),t.setCell(e.Id,i,e.Value)}decorateURL(e){void 0!==this.options.rollingPeriod&&e.searchParams.set("rollingPeriod",`${this.options.rollingPeriod}`)}}const Ds={CumulativeReturnSeriesConverter:us,DividendSeriesConverter:ps,GrowthSeriesConverter:fs,OHLCVSeriesConverter:ys,PriceSeriesConverter:ws,RatingSeriesConverter:vs,ReturnSeriesConverter:Ss,RollingReturnSeriesConverter:Rs};class Is extends Le{constructor(e={}){switch(super(e),e.series?.type){case"CumulativeReturn":this.converter=new Ds.CumulativeReturnSeriesConverter({...e.converter,...e.series});break;case"Dividend":this.converter=new Ds.DividendSeriesConverter({...e.converter,...e.series});break;case"Growth":this.converter=new Ds.GrowthSeriesConverter({...e.converter,...e.series});break;case"Rating":this.converter=new Ds.RatingSeriesConverter({...e.converter,...e.series});break;case"Price":this.converter=new Ds.PriceSeriesConverter({...e.converter,...e.series});break;case"OHLCV":this.converter=new Ds.OHLCVSeriesConverter({...e.converter,...e.series,securities:e.securities});break;case"Return":this.converter=new Ds.ReturnSeriesConverter({...e.converter,...e.series});break;case"RollingReturn":this.converter=new Ds.RollingReturnSeriesConverter({...e.converter,...e.series});break;default:throw new Error("Invalid series type")}this.options=e}async load(){await super.load();const e=this.options,t=e.currencyId,s=e.endDate,n=e.securities,r=e.startDate,o=e.tax,i=e.frequency;if(!n)return this;const a=this.api=this.api||new xe(e.api),l=new Ve("ecint/v1/"+this.converter.path,a.baseURL);l.setSecuritiesOptions(n),t&&l.searchParams.set("currencyId",t),s&&l.setDate("endDate",s),r&&l.setDate("startDate",r),o&&l.searchParams.set("tax",o),i&&l.searchParams.set("frequency",i),this.converter.decorateURL(l);const c=await a.fetch(l),u=await c.json();return this.converter.parse({json:u}),this.table.deleteColumns(),this.table.setColumns(this.converter.getTable().getColumns()),this.setModifierOptions(e.dataModifier)}}ge.DataConnector.registerType("MorningstarTimeSeries",Is);const Ts=Is,As=[{key:"AssetAllocation"},{key:"CreditQuality"},{key:"GlobalStockSector"},{key:"HistoricalPerformanceSeries"},{key:"RegionalExposure"},{key:"RiskStatistics"},{key:"StyleBox"},{key:"TrailingPerformance"},{key:"UnderlyHoldings"}];function Ps(e){switch(e){case"HistoricalPerformanceSeries":return new rt;case"TrailingPerformance":return new at;case"RiskStatistics":return new ot;case"UnderlyHoldings":return new it;case"AssetAllocation":return new lt;case"CreditQuality":return new Ct;case"GlobalStockSector":return new ut;case"RegionalExposure":return new ct;case"StyleBox":return new mt;default:throw new Error(`Unsupported key: ${e}`)}}var Es;!function(e){function t(e){return!!e&&"object"==typeof e&&(void 0===e.breakdowns||s(e.breakdowns))&&(void 0===e.historicalPerformanceSeries||function(e){return e instanceof Array&&(0===e.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.frequency&&"string"==typeof e.returnType&&"string"==typeof e.startDate&&"string"==typeof e.timePeriod&&e.returns instanceof Array&&(0===e.returns.length||function(e){return e instanceof Array&&"string"==typeof e[0]&&"number"==typeof e[1]}(e.returns[0]))}(e[0]))}(e.historicalPerformanceSeries))&&("object"==typeof e.trailingPerformance||void 0===e.trailingPerformance)}function s(e){return!!e&&"object"==typeof e&&e.assetAllocation instanceof Array&&(0===e.assetAllocation.length||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"string"==typeof e.type&&"object"==typeof e.values}(e.assetAllocation[0]))||!e.globalStockSector||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"object"==typeof e.values}(e.globalStockSector?.[0])||!e.regionalExposure||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"object"==typeof e.values}(e.regionalExposure?.[0])||!e.styleBox||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.salePosition&&"object"==typeof e.values}(e.styleBox?.[0])}function n(e){return!!e&&"object"==typeof e&&t(e)&&(void 0===e.benchmark||t(e.benchmark))&&(void 0===e.breakdowns||s(e.breakdowns))&&(void 0===e.status||function(e){return!!e&&"object"==typeof e&&"string"==typeof e.detailedStatusMessage&&"number"==typeof e.statusCode&&"string"==typeof e.statusDescription}(e.status))}e.isResponse=function(e){return!!e&&"object"==typeof e&&n(e.XRay)},e.isXRayResponse=n}(Es||(Es={}));const ks=Es;function js(e,t){return e.map((e=>{const s={identifier:e.id,identifierType:e.idType,holdingType:e.holdingType||t};return e.name&&(s.name=e.name),e.type&&(s.securityType=e.type),e.weight&&(s.weight=e.weight.toString()),s}))}class xs extends Le{constructor(e={}){super(e,As),this.metadata={columns:{}},this.options=e}async load(){await super.load();const e=this.options,t=e.dataPoints?Array.isArray(e.dataPoints)?e.dataPoints:[e.dataPoints]:[],s=e.holdings||[];if(!t[0]||!s.length)return this;const n=[],r=[];for(const e of s)ts(e)&&n.push(e),ns(e)&&r.push(e);const o={benchmarkId:e.benchmarkId||"XIUSA0010V",currencyId:e.currencyId};n.length>r.length?(o.type=3,o.holdings=js(n,o.type)):(o.type=2,o.holdings=js(r,o.type));const i=this.api=this.api||new xe(e.api),a=new Ve("ecint/v1/xray/json",i.baseURL);t.forEach((e=>{a.searchParams.set(e.type+"DataPoints",function(e){return(e=e.map((e=>e instanceof Array?e.join("|"):e))).length?`UseMongoSecurities,RunInThread,${e.join(",")}`:""}(e.dataPoints))}));const l=await i.fetch(a,{body:JSON.stringify(JSON.stringify(o)),headers:{"Content-Type":"application/json"},method:"POST"}),c=await l.json(),u=[];if(ks.isResponse(c))u.push(...c.XRay);else{if(!ks.isXRayResponse(c))throw new Error("Invalid data");u.push(c)}for(const{key:e}of As){const t=Ps(e);for(const e of u)t.parse({json:{...e,benchmark:void 0}}),e.benchmark&&t.parse({json:e});this.dataTables[e].setColumns(t.getTable().getColumns())}return this.metadata={columns:{}},this.setModifierOptions(e.dataModifier)}}ge.DataConnector.registerType("MorningstarXRay",xs);const Ms={GoalAnalysis:Ge,SecurityDetails:It,SecurityCompare:At,RNANews:Ot,RiskScore:Zt,Shared:s,TimeSeries:Ts,XRay:xs,InvestmentScreener:Ft,InvestorPreferences:zt,version:Ie};return t})()));
//# sourceMappingURL=connectors-morningstar.js.map